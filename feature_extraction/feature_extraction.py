# -*- coding: UTF-8 -*-.
import argparse
import os
from pe import PE

def params():
    parser = argparse.ArgumentParser()
    parser.add_argument('files_location', help='Files location')
    params = parser.parse_args()
    return params.files_location

def feature_extraction(pefile):
    return pefile

def read_files(location):
    for root, dirs, files in os.walk(location):
        for f in sorted(files):
            if f.endswith(".exe"):
                file_loc = os.path.join(root, f)
                print f
                pe = PE(file_loc)
                print pe.getImportedDlls()
                print pe.getImportedSymbols()

read_files(params())
